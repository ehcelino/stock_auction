<div class="mb-5">
  <h3>Lote para leilão código <%= @auction_lot.code %></h3>
</div>

<p><%= AuctionLot.human_attribute_name(:start_date) %>: <%= I18n.localize(@auction_lot.start_date) %></p>
<p><%= AuctionLot.human_attribute_name(:end_date) %>: <%= I18n.localize(@auction_lot.end_date) %></p>
<p><%= AuctionLot.human_attribute_name(:min_bid_amount) %>: <%= number_to_currency(@auction_lot.min_bid_amount) %></p>
<p><%= AuctionLot.human_attribute_name(:min_bid_difference) %>: <%= number_to_currency(@auction_lot.min_bid_difference) %></p>
<p><%= AuctionLot.human_attribute_name(:status) %>: <%= AuctionLot.human_attribute_name(@auction_lot.status) %></p>
<p><%= AuctionLot.human_attribute_name(:created_by) %>: <%= User.find(@auction_lot.created_by).email %></p>
<p><%= AuctionLot.human_attribute_name(:approved_by) %>:
  <% if @auction_lot.approved_by.present? %>
    <%= User.find(@auction_lot.approved_by).email %>
  <% end %>
</p>


<% if @auction_lot.items.present? %>
  <h4>Itens deste Lote</h4>
  <table class="table">
    <tr>
      <th>Imagem</th>
      <th>Nome</th>
      <th>Descrição</th>
      <th>Peso</th>
      <th>Dimensões</th>
      <th>Código</th>
      <th>Categoria</th>
    </tr>
    <% @auction_lot.items.each do |item| %>
      <tr>
        <% if item.image.attached? %>
          <td><%= image_tag item.image, class:"img-resize" %> </td>
        <% else %>
          <td></td>
        <% end %>
        <td><%= item.name %></td>
        <td><%= item.description %></td>
        <td><%= item.weight %> g.</td>
        <td><%= item.width %> x <%= item.height %> x <%= item.depth %> cm</td>
        <td><%= item.code %></td>
        <td><%= item.category.name %></td>
      </tr>
    <% end %>
  </table>
<% else %>
  <h4>Este lote ainda não possui itens cadastrados</h4>
<% end %>

<% if !current_user.nil? && current_user.admin? %>

  <% if @auction_lot.status == "pending" %>
    <div class="d-flex gap-3">
      <%= link_to 'Adicionar itens', new_auction_lot_lot_item_path(@auction_lot), class:"btn btn-secondary" %>
      <%= button_to 'Aprovar lote', approved_auction_lot_path, class:"btn btn-secondary" %>
    </div>
  <% end %>

<% end %>


<% if !current_user.nil? && @auction_lot.biddable? %>
  <%= link_to 'Dar um lance', new_auction_lot_bid_path(@auction_lot), class:"btn btn-secondary" %>
<% end %>
